{"ast":null,"code":"import _classCallCheck from\"/Users/bentilden/Documents/GitHub/TextMessageControlCenterFrontend/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/bentilden/Documents/GitHub/TextMessageControlCenterFrontend/node_modules/@babel/runtime/helpers/esm/createClass\";import _possibleConstructorReturn from\"/Users/bentilden/Documents/GitHub/TextMessageControlCenterFrontend/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";import _getPrototypeOf from\"/Users/bentilden/Documents/GitHub/TextMessageControlCenterFrontend/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";import _inherits from\"/Users/bentilden/Documents/GitHub/TextMessageControlCenterFrontend/node_modules/@babel/runtime/helpers/esm/inherits\";import React from'react';import logo from\"./logo.svg\";import'./App.css';import Headroom from\"react-headroom\";import InfiniteScroll from\"react-infinite-scroller\";var api={baseUrl:'https://api.twilio.com'};// Class for sent messages\nvar SentMessages=/*#__PURE__*/function(_React$Component){_inherits(SentMessages,_React$Component);function SentMessages(props){var _this;_classCallCheck(this,SentMessages);_this=_possibleConstructorReturn(this,_getPrototypeOf(SentMessages).call(this,props));_this.state={allMessages:[],nextPage:null,hasMoreItems:true};return _this;}// Loads first page of messages\n_createClass(SentMessages,[{key:\"componentDidMount\",value:function componentDidMount(){var _this2=this;fetch('/messages').then(function(res){return res.json();}).then(function(res){return _this2.setState({allMessages:res.messages,nextPage:res.next_page_uri});}).catch(function(err){return _this2.setState({loaded:true});});}// Load more pages for Infinite Scroll\n},{key:\"loadNextPage\",value:function loadNextPage(page){var self=this;var nextPageUrl=\"\";if(this.state.nextPage){nextPageUrl=api.baseUrl+this.state.nextPage;}var obj={method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({url:nextPageUrl})};fetch('/messages',obj).then(function(res){return res.json();}).then(function(res){if(res){var updatedMessages=self.state.allMessages;res.messages.map(function(message){updatedMessages.push(message);});if(res.nextPage){self.setState({allMessages:updatedMessages,nextPage:res.nextPage});}else{self.setState({hasMoreItems:false});}}}).catch(function(err){console.log(err);});}},{key:\"render\",value:function render(){var loader=React.createElement(\"p\",{className:\"loader\"},\"Loading messages...\");var items=[];this.state.allMessages.map(function(message){items.push(React.createElement(\"div\",{key:message.id,className:\"message\"},React.createElement(\"p\",{className:\"body\"},message.body),React.createElement(\"p\",{className:\"date\"},new Date(message.date_sent).toLocaleString()),React.createElement(\"p\",{className:\"rec\"},message.to)));return items;});return React.createElement(InfiniteScroll,{pageStart:0,loadMore:this.loadNextPage.bind(this),hasMore:this.state.hasMoreItems,loader:loader},React.createElement(\"div\",{className:\"messageFeed\"},items));}}]);return SentMessages;}(React.Component);// Return app\nfunction App(){return React.createElement(\"div\",{className:\"App\"},React.createElement(Headroom,null,React.createElement(\"div\",{className:\"App-header\"},React.createElement(\"img\",{src:logo,className:\"App-logo\",alt:\"logo\"}),React.createElement(\"h1\",null,\"Mantra Health\"))),React.createElement(\"div\",null,React.createElement(\"h2\",null,\"Messages\"),React.createElement(SentMessages,null)));}export default App;","map":{"version":3,"sources":["/Users/bentilden/Documents/GitHub/TextMessageControlCenterFrontend/src/App.js"],"names":["React","Headroom","InfiniteScroll","api","baseUrl","SentMessages","props","state","allMessages","nextPage","hasMoreItems","fetch","then","res","json","setState","messages","next_page_uri","catch","err","loaded","page","self","nextPageUrl","obj","method","headers","body","JSON","stringify","url","updatedMessages","map","message","push","console","log","loader","items","id","Date","date_sent","toLocaleString","to","loadNextPage","bind","Component","App","logo"],"mappings":"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","sourcesContent":["import React from 'react';\nimport logo from './logo.svg';\nimport './App.css';\nimport Headroom from \"react-headroom\";\nimport InfiniteScroll from \"react-infinite-scroller\";\n\nconst api = {\n  baseUrl: 'https://api.twilio.com'\n};\n\n// Class for sent messages\nclass SentMessages extends React.Component {\n  constructor(props) {\n      super(props);\n      this.state = {\n        allMessages: [],\n        nextPage: null,\n        hasMoreItems: true\n      }\n  }\n\n  // Loads first page of messages\n  componentDidMount() {\n    fetch('/messages')\n      .then(res => res.json())\n      .then(res => this.setState({\n              allMessages: res.messages,\n              nextPage: res.next_page_uri\n            }))\n      .catch((err) => this.setState({ loaded: true }));\n  }\n\n  // Load more pages for Infinite Scroll\n  loadNextPage(page) {\n    var self = this;\n    let nextPageUrl = \"\";\n    if (this.state.nextPage) {\n      nextPageUrl = api.baseUrl + this.state.nextPage;\n    }\n    const obj = {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json'\n      },\n      body: JSON.stringify({\n        url : nextPageUrl\n      })\n    };\n    fetch('/messages', obj)\n      .then(res => res.json())\n      .then(res => {\n        if (res) {\n          var updatedMessages = self.state.allMessages;\n          res.messages.map(message => {\n            updatedMessages.push(message);\n          })\n          if (res.nextPage) {\n            self.setState({\n              allMessages: updatedMessages,\n              nextPage: res.nextPage\n            });\n          } else {\n            self.setState({\n              hasMoreItems: false\n            });\n          }\n        }\n      })\n      .catch((err) => {console.log(err);});\n  }\n\n  render() {\n    const loader = <p className=\"loader\">Loading messages...</p>;\n\n    var items = [];\n    this.state.allMessages.map(message => {\n      items.push(\n        <div key={message.id} className=\"message\">\n        <p className=\"body\">{message.body}</p>\n        <p className=\"date\">{new Date(message.date_sent).toLocaleString()}</p>\n        <p className=\"rec\">{message.to}</p>\n      </div>\n      );\n      return items;\n    });\n\n    return (\n        <InfiniteScroll\n            pageStart={0}\n            loadMore={this.loadNextPage.bind(this)}\n            hasMore={this.state.hasMoreItems}\n            loader={loader}>\n\n            <div className=\"messageFeed\">\n                {items}\n            </div>\n        </InfiniteScroll>\n    );\n  }\n}\n\n// Return app\nfunction App() {\n  return (\n    <div className=\"App\">\n      <Headroom>\n        <div className=\"App-header\">\n          <img src={logo} className=\"App-logo\" alt=\"logo\" />\n          <h1>Mantra Health</h1>\n        </div>\n      </Headroom>\n      <div>\n        <h2>Messages</h2>\n        <SentMessages />\n      </div>\n    </div>\n  );\n}\n\nexport default App;\n"]},"metadata":{},"sourceType":"module"}